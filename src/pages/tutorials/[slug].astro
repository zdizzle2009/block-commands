---
import { Post } from "../../components/post";
import { reader } from "../../keystatic/reader";
import MainLayout from "../../components/main-layout.astro";

const post = await reader.collections.tutorials.read(Astro.params.slug ?? '');

if (!post) {
	return new Response(null, {
		status: 404,
		statusText: 'Not found'
	});
}

const document = await post.content();

export async function getStaticPaths() {
	const posts = await reader.collections.tutorials.all();
	return posts.map((post) => ({ params: { slug: post.slug } }));
}
---

<MainLayout title={post.title} description={post.description}>
	<Post document={document} post={post} />
</MainLayout>
